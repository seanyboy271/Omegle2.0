(this.webpackJsonpChatBot_client=this.webpackJsonpChatBot_client||[]).push([[0],{57:function(e,t,a){e.exports=a(96)},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},88:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a.n(c),l=(a(62),a(9)),s=(a(63),a(56)),u=(a(64),a(19)),i=a.n(u),m=a(24),f=a(10),p=a(8),v=a(37),d=a(15),E=a.n(d),b=a(5);var h=function(e){var t=e.getUsername,a=(e.globalUserName,Object(n.useState)(!1)),c=Object(l.a)(a,2),o=c[0],s=c[1],u=Object(b.e)(),d=Object(n.useState)(),h=Object(l.a)(d,2),g=h[0],j=h[1],O=Object(n.createRef)(),w=function(){return s(!1)},N=function(){var e=Object(m.a)(i.a.mark((function e(a){var n,r,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,E.a.post("".concat("/api","/createRoom"),{user:{userName:null===(n=O.current)||void 0===n?void 0:n.value}});case 4:o=e.sent.data,console.log("createroom usename val",null===(r=O.current)||void 0===r?void 0:r.value),t(null===(c=O.current)||void 0===c?void 0:c.value),w(),u.push("/".concat(o.id)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),j(e.t0.response.message||e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{variant:"primary",onClick:function(){return s(!0)}},"Create Room"),r.a.createElement(p.a,{show:o,onHide:w},r.a.createElement(p.a.Header,{closeButton:!0},r.a.createElement(p.a.Title,null,"Create Room"),g&&r.a.createElement(v.a,{variant:"danger",onClose:function(){j(void 0)},dismissible:!0},g)),r.a.createElement(p.a.Body,null,r.a.createElement("input",{ref:O,type:"text",placeholder:"Enter username"})),r.a.createElement(p.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:w},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(e){return N(e)}},"Save Changes"))))};a(88);var g=function(e){var t=e.getUsername,a=(e.globalUserName,Object(n.useState)(!1)),c=Object(l.a)(a,2),o=c[0],s=c[1],u=Object(b.e)(),d=Object(n.useState)(""),h=Object(l.a)(d,2),g=h[0],j=h[1],O=Object(n.useState)(""),w=Object(l.a)(O,2),N=w[0],y=w[1],C=Object(n.useState)(),k=Object(l.a)(C,2),S=k[0],R=k[1],U=function(){return s(!1)},B=function(){var e=Object(m.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault();try{E.a.post("".concat("/api","/joinRoom/").concat(g),{user:{username:N}}),U(),u.push("/".concat(g)),""!==N&&t(N)}catch(n){R("Error ".concat(n.response.status,": ").concat(n.response.data))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{variant:"primary",onClick:function(){return s(!0)}},"Join Room"),r.a.createElement(p.a,{show:o,onHide:U},r.a.createElement(p.a.Header,{closeButton:!0},r.a.createElement(p.a.Title,null,"Join Room"),S&&r.a.createElement(v.a,{variant:"danger",onClose:function(){R(void 0)},dismissible:!0},S)),r.a.createElement(p.a.Body,null,r.a.createElement("input",{type:"text",placeholder:"Enter username",onChange:function(e){y(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Enter room ID",onChange:function(e){return j(e.target.value)}})),r.a.createElement(p.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:U},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(e){return B(e)}},"Join"))))};function j(e){var t=e.globalUserName,a=Object(b.e)();return r.a.createElement(f.a,{variant:"danger",onClick:function(){!function(){n.apply(this,arguments)}()}}," Leave Room");function n(){return(n=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E.a.post("".concat("/api","/leaveRoom"),{user:{username:t}}),a.push("/");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}var O=a(55),w=a(99),N=a(100),y=a(101),C=a(102),k=a(103),S=a(104);var R=function(e){var t=e.getUserName,a=e.userName,n=Object(b.f)().roomId;return r.a.createElement(s.a,{className:"nav"},r.a.createElement("div",{className:"buttonGroup"},r.a.createElement(O.a,null,r.a.createElement(h,{getUsername:t,globalUserName:a}),r.a.createElement(g,{getUsername:t,globalUserName:a}),n&&r.a.createElement(j,{globalUserName:a}))),n?r.a.createElement("div",{className:"roomCount"},"Current Room ID: ",n,r.a.createElement("div",{className:"share"},r.a.createElement(w.a,{subject:"".concat(a," wants you to join their chat room!"),url:window.location.href},r.a.createElement(N.a,{size:"32",round:!0})),r.a.createElement(y.a,{url:window.location.href},r.a.createElement(C.a,{size:"32",round:!0})),r.a.createElement(k.a,{url:window.location.href},r.a.createElement(S.a,{size:32,round:!0})))):"Not in room")};a(91),a(92);var U=function(e){var t=e.message;return r.a.createElement("div",{className:"messageContainer"},t.split("\n").map((function(e){return r.a.createElement("p",{className:"messageLine"},e)})))};var B=function(e){var t=e.ws,a=Object(n.useState)(""),c=Object(l.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)((function(){t?t.onmessage=function(e){s("".concat(o,"\n").concat(e.data))}:s("")}),[t,o]),r.a.createElement("div",{className:"display"},r.a.createElement(U,{message:o}))};a(93);var x=function(e){var t=e.ws,a=e.userName,c=Object(n.useState)(""),o=Object(l.a)(c,2),s=o[0],u=o[1],i=r.a.createRef();return r.a.createElement("div",{className:"input"},r.a.createElement("input",{ref:i,className:"messageInput",type:"text",placeholder:"type message here",onChange:function(e){u(e.target.value)}}),r.a.createElement(f.a,{className:"sendButton",onClick:function(e){!function(e,t,n){i.current&&(i.current.value="");null===e||void 0===e||e.send("".concat(a,": ").concat(t))}(t,s)}},"Send"))};a(94);var I=function(e){var t=e.userName,a=e.getUserName,c=Object(b.f)().roomId,o=Object(n.useState)(),s=Object(l.a)(o,2),u=s[0],i=s[1],m=Object(n.useState)(-1),v=Object(l.a)(m,2),d=v[0],h=v[1],g=Object(b.e)(),j=function(){return g.push("/")},O=Object(n.createRef)();return Object(n.useEffect)((function(){if(c&&d!==c&&t){h(c),i(new WebSocket("ws://localhost:8999/".concat(c,"?userName=").concat(t)));E.a.post("".concat("/api","/getRoomByUser"),{user:{username:t}}).then((function(e){e.data||E.a.post("".concat("/api","/joinRoom/").concat(c),{user:{username:t}})})).catch((function(e){console.error(e)}));if(u)return function(){u.close()}}else!c&&u&&(console.log("closing connection"),null===u||void 0===u||u.close(1e3,t),i(void 0))}),[c,d,u,t]),t||!c?r.a.createElement("div",{className:"chat"},r.a.createElement(B,{ws:u}),r.a.createElement(x,{ws:u,userName:t})):r.a.createElement(p.a,{show:!0,onHide:j},r.a.createElement(p.a.Header,{closeButton:!0},r.a.createElement(p.a.Title,null,"Create username")),r.a.createElement(p.a.Body,null,r.a.createElement("input",{ref:O,type:"text",placeholder:"Enter username"})),r.a.createElement(p.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:j},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(){return function(){var e;a(null===(e=O.current)||void 0===e?void 0:e.value)}()}},"Join")))},H=a(23);var J=function(){var e=sessionStorage.getItem("userName")||"",t=Object(n.useState)(e),a=Object(l.a)(t,2),c=a[0],o=a[1],s=function(e){console.log("Chanigna app state username to",e),o(e),sessionStorage.setItem("userName",e)};return Object(n.useEffect)((function(){window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue="",E.a.post("".concat("/api","/leaveRoom"),{user:{username:c}})}))})),r.a.createElement(H.a,null,r.a.createElement(b.a,{path:["/:roomId",""]},r.a.createElement(R,{getUserName:s,userName:c}),r.a.createElement(I,{userName:c,getUserName:s})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(95);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.3ba8021c.chunk.js.map