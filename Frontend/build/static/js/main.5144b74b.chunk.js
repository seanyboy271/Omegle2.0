(this.webpackJsonpChatBot_client=this.webpackJsonpChatBot_client||[]).push([[0],{57:function(e,t,a){e.exports=a(96)},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},88:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),c=a.n(o),l=(a(62),a(9)),u=(a(63),a(56)),s=(a(64),a(19)),i=a.n(s),m=a(24),f=a(10),v=a(8),d=a(25),p=a(15),E=a.n(p),b=a(5);var h=function(e){var t=e.getUsername,a=(e.globalUserName,Object(n.useState)(!1)),o=Object(l.a)(a,2),c=o[0],u=o[1],s=Object(b.e)(),p=Object(n.useState)(),h=Object(l.a)(p,2),g=h[0],j=h[1],w=Object(n.createRef)(),O=function(){return u(!1)},N=function(){var e=Object(m.a)(i.a.mark((function e(a){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,E.a.post("".concat("/api","/createRoom"),{user:{userName:null===(n=w.current)||void 0===n?void 0:n.value}});case 4:c=e.sent.data,console.log("createroom usename val",null===(r=w.current)||void 0===r?void 0:r.value),t(null===(o=w.current)||void 0===o?void 0:o.value),O(),s.push("/".concat(c.id)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),j(e.t0.response.message||e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{variant:"primary",onClick:function(){return u(!0)}},"Create Room"),r.a.createElement(v.a,{show:c,onHide:O},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"Create Room"),g&&r.a.createElement(d.a,{variant:"danger",onClose:function(){j(void 0)},dismissible:!0},g)),r.a.createElement(v.a.Body,null,r.a.createElement("input",{ref:w,type:"text",placeholder:"Enter username"})),r.a.createElement(v.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:O},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(e){return N(e)}},"Save Changes"))))};a(88);var g=function(e){var t=e.getUsername,a=(e.globalUserName,Object(n.useState)(!1)),o=Object(l.a)(a,2),c=o[0],u=o[1],s=Object(b.e)(),p=Object(n.useState)(""),h=Object(l.a)(p,2),g=h[0],j=h[1],w=Object(n.useState)(""),O=Object(l.a)(w,2),N=O[0],y=O[1],C=Object(n.useState)(),k=Object(l.a)(C,2),S=k[0],R=k[1],U=function(){return u(!1)},x=function(){var e=Object(m.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault();try{E.a.post("".concat("/api","/joinRoom/").concat(g),{user:{username:N}}),U(),s.push("/".concat(g)),""!==N&&t(N)}catch(n){R("Error ".concat(n.response.status,": ").concat(n.response.data))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{variant:"primary",onClick:function(){return u(!0)}},"Join Room"),r.a.createElement(v.a,{show:c,onHide:U},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"Join Room"),S&&r.a.createElement(d.a,{variant:"danger",onClose:function(){R(void 0)},dismissible:!0},S)),r.a.createElement(v.a.Body,null,r.a.createElement("input",{type:"text",placeholder:"Enter username",onChange:function(e){y(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Enter room ID",onChange:function(e){return j(e.target.value)}})),r.a.createElement(v.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:U},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(e){return x(e)}},"Join"))))};function j(e){var t=e.globalUserName,a=Object(b.e)();return r.a.createElement(f.a,{variant:"danger",onClick:function(){!function(){n.apply(this,arguments)}()}}," Leave Room");function n(){return(n=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E.a.post("".concat("/api","/leaveRoom"),{user:{username:t}}),a.push("/");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}var w=a(55),O=a(99),N=a(100),y=a(101),C=a(102),k=a(103),S=a(104);var R=function(e){var t=e.getUserName,a=e.userName,n=Object(b.f)().roomId;return r.a.createElement(u.a,{className:"nav"},r.a.createElement("div",{className:"buttonGroup"},r.a.createElement(w.a,null,r.a.createElement(h,{getUsername:t,globalUserName:a}),r.a.createElement(g,{getUsername:t,globalUserName:a}),n&&r.a.createElement(j,{globalUserName:a}))),n?r.a.createElement("div",{className:"roomCount"},"Current Room ID: ",n,r.a.createElement("div",{className:"share"},r.a.createElement(O.a,{subject:"".concat(a," wants you to join their chat room!"),url:window.location.href},r.a.createElement(N.a,{size:"32",round:!0})),r.a.createElement(y.a,{url:window.location.href},r.a.createElement(C.a,{size:"32",round:!0})),r.a.createElement(k.a,{url:window.location.href},r.a.createElement(S.a,{size:32,round:!0})))):"Not in room")};a(91),a(92);var U=function(e){var t=e.message;return r.a.createElement("div",{className:"messageContainer"},t.split("\n").map((function(e){return r.a.createElement("p",{className:"messageLine"},e)})))};var x=function(e){var t=e.ws,a=Object(n.useState)(""),o=Object(l.a)(a,2),c=o[0],u=o[1];return Object(n.useEffect)((function(){t?t.onmessage=function(e){u("".concat(c,"\n").concat(e.data))}:u("")}),[t,c]),r.a.createElement("div",{className:"display"},r.a.createElement(U,{message:c}))};a(93);var B=function(e){var t=e.ws,a=e.userName,n=r.a.createRef();return r.a.createElement("div",{className:"input"},r.a.createElement("input",{ref:n,className:"messageInput",type:"text",placeholder:"type message here"}),r.a.createElement(f.a,{className:"sendButton",onClick:function(e){!function(e,t){if(n.current){var r;null===e||void 0===e||e.send("".concat(a,": ").concat(null===(r=n.current)||void 0===r?void 0:r.value)),n.current.value=""}}(t)}},"Send"))};a(94);var I=function(e){var t=e.userName,a=e.getUserName,o=Object(b.f)().roomId,c=Object(n.useState)(),u=Object(l.a)(c,2),s=u[0],i=u[1],m=Object(n.useState)(-1),p=Object(l.a)(m,2),h=p[0],g=p[1],j=Object(b.e)(),w=Object(n.useState)(),O=Object(l.a)(w,2),N=O[0],y=O[1],C=function(){return j.push("/")},k=Object(n.createRef)();return Object(n.useEffect)((function(){if(o&&h!==o&&t){g(o);var e=window.location.href.replace(/^http/,"ws"),a=new WebSocket("".concat(e,"?userName=").concat(t));i(a);E.a.post("".concat("/api","/getRoomByUser"),{user:{username:t}}).then((function(e){e.data||E.a.post("".concat("/api","/joinRoom/").concat(o),{user:{username:t}}).catch((function(e){y(null===e||void 0===e?void 0:e.response.data)}))})).catch((function(e){}));if(s)return function(){s.close()}}else!o&&s&&(console.log("closing connection"),null===s||void 0===s||s.close(1e3,t),i(void 0))}),[o,h,s,t]),N?r.a.createElement(d.a,{variant:"danger",onClose:function(){return y(void 0)}},N+". Try creating new room, or joining an existing one"):t||!o?r.a.createElement("div",{className:"chat"},r.a.createElement(x,{ws:s}),r.a.createElement(B,{ws:s,userName:t})):r.a.createElement(v.a,{show:!0,onHide:C},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"Create username")),r.a.createElement(v.a.Body,null,r.a.createElement("input",{ref:k,type:"text",placeholder:"Enter username"})),r.a.createElement(v.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:C},"Close"),r.a.createElement(f.a,{variant:"primary",type:"submit",onClick:function(){return function(){var e;a(null===(e=k.current)||void 0===e?void 0:e.value)}()}},"Join")))},H=a(23);var J=function(){var e=sessionStorage.getItem("userName")||"",t=Object(n.useState)(e),a=Object(l.a)(t,2),o=a[0],c=a[1],u=function(e){c(e),sessionStorage.setItem("userName",e)};return Object(n.useEffect)((function(){window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue="","/"!==window.location.pathname&&(console.log("Pathname",window.location.pathname),E.a.post("".concat("/api","/leaveRoom"),{user:{username:o}}))}))})),r.a.createElement(H.a,null,r.a.createElement(b.a,{path:["/:roomId",""]},r.a.createElement(R,{getUserName:u,userName:o}),r.a.createElement(I,{userName:o,getUserName:u})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(95);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.5144b74b.chunk.js.map